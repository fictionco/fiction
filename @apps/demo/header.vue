<template>
  <div class="switcher">
    <div class="brand">
      <factor-link path="/" class="logo">
        <div class="fiction-icon">
          <svg
            width="846"
            height="212"
            viewBox="0 0 846 212"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M410.579 81.8361H448.856L432.415 185.056C431.924 188.485 431.645 191.704 431.645 194.153C431.645 199.542 432.415 202.761 432.415 202.761H396.863C396.863 202.761 395.883 199.822 395.883 194.153C395.883 192.194 395.883 189.745 396.163 187.015H395.883C385.596 198.772 370.411 205.42 354.665 205.42C325.064 202.901 312.328 181.907 312.328 153.215C312.328 115.916 332.832 80.5066 374.539 80.5066C387.276 80.5066 402.041 84.0056 408.62 95.7623C409.109 91.1435 409.809 86.5247 410.579 81.8361ZM378.108 110.738C358.024 110.738 345.708 129.842 345.708 148.527C345.708 162.523 353.826 172.81 368.241 172.81C388.326 172.81 400.642 153.705 400.642 135.021C400.642 121.095 392.594 110.738 378.108 110.738Z"
              fill="white"
            />
            <path
              d="M542.492 122.775C536.331 114.657 525.344 111.018 515.55 111.018C495.463 111.018 481.469 128.933 481.469 148.318C481.469 163.783 491.547 172.81 506.733 172.81C517.296 172.81 530.034 168.402 538.36 161.753L541.79 191.705C530.034 201.292 509.879 205.421 495.463 205.421C464.812 205.421 442.771 185.057 442.771 154.196C442.771 112.978 473.912 79.6672 515.829 79.6672C527.864 79.6672 540.039 80.787 548.861 90.0944L542.492 122.775Z"
              fill="white"
            />
            <path
              d="M610.23 81.8387H636.195L631.015 112H605.261C602.534 128.445 597.636 146.57 597.636 163.225C597.636 170.363 601.062 172.532 607.714 172.532C611.63 172.532 615.829 171.763 619.47 170.293L616.531 201.434C607.431 203.673 598.406 205.353 588.819 205.353C569.434 205.353 557.885 196.535 557.885 176.381C557.885 155.037 563.763 132.504 566.986 111.86H550.54L555.437 81.6987H571.883L574.331 66.5132C574.822 62.8041 574.822 59.6548 574.822 56.7158C574.822 52.0272 574.331 49.0881 574.331 49.0881H612.332C612.332 49.0881 613.101 51.8175 613.101 57.2059C613.101 60.145 612.89 63.8537 612.12 68.2627L610.23 81.8387Z"
              fill="white"
            />
            <path
              d="M678.18 205.421C646.759 205.421 622.477 187.506 622.477 154.405C622.477 111.718 654.6 79.5974 697.984 79.5974C729.616 79.5974 753.691 97.7219 753.691 130.822C753.691 173.58 721.847 205.421 678.18 205.421ZM693.158 111.018C673.071 111.018 661.526 130.612 661.526 148.807C661.526 162.523 668.872 172.81 683.36 172.81C703.443 172.81 714.992 153.216 714.992 135.021C714.92 121.305 707.575 111.018 693.158 111.018Z"
              fill="white"
            />
            <path
              d="M838.226 118.156H836.264C832.348 115.917 827.447 115.217 823.04 115.217C804.425 115.217 797.079 133.622 794.838 149.087L786.232 202.762H747.953L764.115 99.7514C764.606 96.0427 764.885 92.4038 764.885 89.4643C764.885 84.7757 764.399 81.8367 764.399 81.8367H802.395C802.395 81.8367 803.165 84.566 803.165 89.9544C803.165 92.4038 802.886 96.1125 802.188 99.0516C809.322 87.785 820.313 79.6672 834.306 79.6672C837.736 79.6672 842.916 80.1569 845.855 81.9064L838.226 118.156Z"
              fill="white"
            />
            <path
              d="M316.946 27.1841C281.047 30.6131 271.249 51.467 266.351 81.8383H251.375L246.687 111.999H261.732L246.757 205.212H285.035L299.941 111.999H319.186L324.994 81.6281L304.63 81.8383C306.589 70.2918 308.269 64.3435 319.395 59.0248C324.434 56.6456 324.994 56.016 335.771 56.6456L341.649 28.6537C333.811 26.1344 327.093 26.2044 316.946 27.1841Z"
              fill="white"
            />
            <path
              d="M182.865 212H91.1216C85.1733 212 79.5747 209.691 75.3758 205.492L5.39631 135.512C0.147832 130.264 -1.4617 122.356 1.40747 115.498C4.27663 108.57 10.9247 104.091 18.4125 104.091H104.068V18.3662C104.068 10.8783 108.546 4.23028 115.404 1.36111C122.192 -1.43808 130.31 0.171457 135.488 5.34998L205.468 75.3296C209.667 79.5986 211.977 85.127 211.977 91.0749V182.819C212.046 198.914 198.96 212 182.865 212ZM94.9703 180.439H180.486V94.924L135.628 50.0671V135.582H50.1134L94.9703 180.439Z"
              fill="white"
            />
          </svg>

          <div class="sub-name">Demos</div>
        </div>
      </factor-link>
    </div>
    <div class="selector nav-area">
      <plugin-selector />
    </div>
    <div class="actions nav-area">
      <account-menu v-if="!userLoading && isLoggedIn()" />
      <factor-link
        v-else-if="!userLoading"
        class="nav-link"
        event="sign-in-modal"
        data-test="signin-link"
      >Demo Login / Sign Up</factor-link>
    </div>
  </div>
</template>

<script lang="ts">
import { isLoggedIn, userInitialized } from "@factor/user"
import { factorLink } from "@factor/ui"
import { accountMenu } from "@factor/plugin-standard-signin"
export default {
  components: { pluginSelector: () => import("./selector.vue"), factorLink, accountMenu },
  data() {
    return {
      userLoading: true,
    }
  },
  async mounted(this: any) {
    await userInitialized()

    this.userLoading = false
  },
  methods: {
    isLoggedIn,
  },
}
</script>
<style lang="postcss">
.switcher {
  display: grid;
  grid-template-columns: max-content 1fr 200px;
  grid-template-areas: "grid-brand grid-selector grid-actions";
  grid-column-gap: 1rem;
  padding: 0 1rem;
  width: 100%;
  background: var(--color-text);
  color: #fff;
  align-items: center;
  justify-content: space-between;

  .brand {
    grid-area: grid-brand;
  }
  .selector {
    grid-area: grid-selector;
  }
  .actions {
    grid-area: grid-actions;
    justify-self: flex-end;
  }
  @media (max-width: 900px) {
    grid-template-columns: max-content 1fr;
    grid-template-areas: "grid-brand grid-actions" "grid-selector grid-selector";
  }

  .logo {
    display: flex;
    align-items: center;
    color: inherit;
    .sub-name {
      font-weight: 700;
      margin-left: 0.5rem;
      text-transform: uppercase;
      opacity: 0.3;
      font-size: 0.8em;
      line-height: 1;
    }
  }
  .fiction-icon {
    display: flex;
    align-items: flex-end;
    border-radius: 0.5rem;

    padding: 0.5rem 1rem 0.6rem 1rem;
    a {
      display: block;
    }
    svg {
      height: 1.25rem;
      width: auto;
      display: block;
    }
  }

  .nav-link {
    background-color: rgba(255, 255, 255, 0.1);
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3);
    border-radius: 0.25rem;
    padding: 0.5em 1rem;
    font-size: 0.9em;
    font-weight: 600;
    &:hover {
      opacity: 0.8;
    }
  }

  .nav-area {
    padding: 0.5rem;
  }
  .selector {
    select {
      font-size: 0.9em;
      background-color: rgba(255, 255, 255, 0.1);
      color: #fff;
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3);
    }
  }
}
</style>
